{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2016-12-20-serverless-wordpress-hosting-with-shifter/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"1a4a3dd0-ced2-506e-8af9-250bdab5eb68","excerpt":"Shifter is a SaaS hosting product that turns any type of WordPress website or blog into a static site. In one click your site can be converted into static HTML…","html":"<img align=\"right\" width=\"250\" height=\"250\" src=\"https://s3.amazonaws.com/shifter-serverless-blog/shifter-square.png\">\n<p><a href=\"https://getshifter.io\">Shifter</a> is a SaaS hosting product that turns any type of WordPress website or blog into a static site. In one click your site can be converted into static HTML files, moved to S3 and delivered through CloudFront. In this post the Shifter team will share more about our motivation for building this project along with a sneak peek at the backend. </p>\n<h2>Introducing Microservices to WordPress</h2>\n<p>WordPress currently serves about 25% of all sites on the web. People use it in many different ways - ranging from beginner blogs to big media websites to web applications. In our experience, WordPress is favored by many because it’s simple and powerful.</p>\n<p>The Shifter team consists of WordPress pros who contribute to the project actively. As AWS Advanced Technology Partners, we’re also AWS experts. Through repeatedly creating hosting solutions for large-scale, high traffic websites, we realized an opportunity to introduce the concept of microservices into the context of WordPress.</p>\n<h2>Solving the Scalability Issue</h2>\n<p>Maintaining WordPress sites demands significantly more time and attention as the website gains popularity (and more traffic) or the number of websites you manage increases. In some cases, the amount of time spent maintaining the backend can exceed the work put into new content. This can cause major problems for WordPress users as their websites grow. </p>\n<p>Shifter addresses these issues by converting a dynamic WordPress site into static files. </p>\n<p>What if you want to make changes to your site? WordPress is there when you need it, on demand, running from a Docker container that only you can see. After you’ve made your changes Shifter goes to work generating those updates, delivering them across a global CDN, and the Docker container and WordPress backend will vanish again. Shifter brings the simplicity and benefits of serverless architecture to WordPress. </p>\n<p>Now, we’ll share some of the architecture of the Shifter backend and a few lessons learned.</p>\n<h2>A Glimpse of the Shifter Backend</h2>\n<p>Shifter is built according to the microservices concept. The backend relies on highly available and durable services like S3, Lambda, DynamoDB and API Gateway.</p>\n<p><img src=\"https://s3.amazonaws.com/shifter-serverless-blog/sitegenerator.png\" alt=\"The overall outlook of Shifter Service\" title=\"The overall outlook of Shifter Service\"></p>\n<p><strong>Here’s the architecture of the user console:</strong></p>\n<p><img src=\"https://s3.amazonaws.com/shifter-serverless-blog/dashboard.png\" alt=\"How the console architecture look like\" title=\"How the console architecture look like\"></p>\n<p>We chose to set up the console architecture with the Serverless Framework. It’s a Single-Page Application. Here are some highlights:</p>\n<ul>\n<li>HTML, CSS, Javascript files are hosted on S3</li>\n<li>User registration data is stored with Cognito User Pool</li>\n<li>Dynamic process is handled by API Gateway, Lambda &#x26; DynamoDB</li>\n</ul>\n<p>The biggest advantage of using this architecture is that you don’t need to maintain servers or manage user credentials, so you can concentrate on the code.</p>\n<p>Here’s a snippet of the code what runs on Lambda:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> cb</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Projects</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>method<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'POST'</span><span class=\"token operator\">:</span>\n      Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">postCheckInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">checkMaxUse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">errorHandle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> cb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'GET'</span><span class=\"token operator\">:</span>\n      Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">errorHandle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> cb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     \n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'DELETE'</span><span class=\"token operator\">:</span>\n      Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">checkOwnSite</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">errorHandle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> cb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'PUT'</span><span class=\"token operator\">:</span>\n      Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">checkOwnSite</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> projects<span class=\"token punctuation\">.</span><span class=\"token function\">updateProjectName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">errorHandle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> cb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Lambda functions are allocated to APIs one by one. The process is divided according to what HTTP method the API will be taken through. There are multiple APIs, which the Serverless Framework allows us to deploy at once. It’s crucial (and awesome!) that we can deploy multiple APIs with one tool.</p>\n<h2>Lessons Learned &#x26; Next Milestones</h2>\n<h3>Integration Testing</h3>\n<p>Through this development process we’ve learned that it’s vital to have automated tests in the Serverless Framework - not only unit tests, but also automated integration tests. For the microservices approach to work well, everything needs to talk to each other. We’re currently trying to automate integration tests among the multiple different microservices.</p>\n<h3>Powering Dynamic Features with Static Files</h3>\n<p>Our next goal is to give Shifter the same capabilities as WordPress blogs, websites, and apps in traditional settings. Bringing new features such as SFTP, WP-Cron, and the ability to re-generate a single page are up next. We expect to face some obstacles here, and potentially solving them will be more difficult than solving them in traditional setups, such as LAMP. But we’re up for the challenge and eager to share our learnings as we go. We’d love your feedback along the way. <a href=\"https://getshifter.io/blog/shifter-launching-campaign/\">Try Shifter for free</a> through the end of January and let us know what you think.</p>\n<h2>Taking It to the Next Level with the Shifter Kickstarter</h2>\n<p>The Shifter team recently launched a <a href=\"https://www.kickstarter.com/projects/225627578/shifter-serverless-hosting-for-wordpress/updates\">Kickstarter</a> to help us reach our next development milestones. Check it out if you’re interested in supporting our mission!</p>","frontmatter":{"title":"How Shifter Introduced Serverless Hosting to WordPress Using AWS, DynamoDB & the Serverless Framework","date":"December 20, 2016","description":"Learn how Shifter transforms WordPress blogs and websites into static sites to make them faster, more secure and scalable in this guest post."}}},"pageContext":{"slug":"/posts/2016-12-20-serverless-wordpress-hosting-with-shifter/","previous":{"fields":{"slug":"/posts/2016-12-15-serverless-office-hours-recap/"},"frontmatter":{"title":"Talking re:Invent & the Latest Serverless Framework Features in the Dec. 8th Office Hours Live Video Recording"}},"next":{"fields":{"slug":"/posts/2017-01-04-writing-serverless-plugins/"},"frontmatter":{"title":"How To Write Your First Plugin For The Serverless Framework - Part 1"}}}}}