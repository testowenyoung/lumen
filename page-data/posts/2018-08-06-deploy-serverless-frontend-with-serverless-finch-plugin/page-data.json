{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2018-08-06-deploy-serverless-frontend-with-serverless-finch-plugin/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"1f53738f-1c00-58e6-8c5b-3e9304c10c16","excerpt":"If you’ve already been using the Serverless Framework for your development projects on AWS, you may have realized that deploying the frontend portion of your…","html":"<img src=\"https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/serverless-fich-plugin/serverless-finch-plugin.jpg\">\n<p>If you’ve already been using <a href=\"https://serverless.com/framework/\">the Serverless Framework</a> for your development projects on AWS, you may have realized that deploying the frontend portion of your applications isn’t built in. </p>\n<p>Fortunately for you, the Serverless Framework is extensible. Meaning, there’s a plugin for that: <a href=\"https://github.com/fernando-mc/serverless-finch\">Serverless Finch</a>.</p>\n<p>In this post, I’ll show you how you can use the Serverless Finch plugin to deploy your own static website assets in a way that is compatible with most modern frontend frameworks or less-complex static sites.</p>\n<h2>Requirements</h2>\n<p>First off, if you haven’t already, you’ll need to:</p>\n<ol>\n<li>install the <a href=\"https://serverless.com\">Serverless Framework</a></li>\n<li>configure AWS API keys that at least give you broad S3 permissions (If you’ve done any work with the Serverless Framework, you probably already have these) </li>\n<li>install Node.js and npm (I’m using node v6.10.3, but more modern versions should work too)</li>\n<li>prepare some static website files and put them in a folder called <code class=\"language-text\">client/dist</code> in the same folder as your Serverless Framework project</li>\n<li>create an <code class=\"language-text\">index.html</code> and an <code class=\"language-text\">error.html</code> file to deploy to S3 as a default landing page and error page</li>\n</ol>\n<p>Steps 4 and 5 are very customizable so I’ll explain more about them in the <a href=\"#advanced-features\">advanced features section</a> below.</p>\n<h2>1-2-3 Install, configure, deploy, done.</h2>\n<p>After you’ve completed the initial steps above, the deployment process should be quick and easy:</p>\n<p>From within an existing Serverless Framework project directory, install the Serverless Finch plugin with <code class=\"language-text\">npm install --save serverless-finch</code>.</p>\n<p>Then, update your <code class=\"language-text\">serverless.yml</code> file by adding this: </p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> serverless<span class=\"token punctuation\">-</span>finch\n\n<span class=\"token key atrule\">custom</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">bucketName</span><span class=\"token punctuation\">:</span> your<span class=\"token punctuation\">-</span>unique<span class=\"token punctuation\">-</span>s3<span class=\"token punctuation\">-</span>bucketname</code></pre></div>\n<p><strong>Warning step:</strong> Make sure that you have configured an S3 bucket purely dedicated to storing the files for this frontend. The plugin <strong>will delete and overwrite the current contents of the bucket</strong>.</p>\n<p>Now, warning step completed, run <code class=\"language-text\">serverless client deploy</code> and see the magic happen! Remember that <em>by default</em> the plugin looks for your already-built frontend code in <code class=\"language-text\">./client/dist</code>.</p>\n<p>Don’t have an <code class=\"language-text\">index.html</code> or other website files yet? Here’s a quick script you can run before <code class=\"language-text\">serverless client deploy</code> just to give yourself a barebones page and see how things work: </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> -p client/dist\n<span class=\"token function\">touch</span> client/dist/index.html client/dist/error.html\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Go Serverless\"</span> <span class=\"token operator\">>></span> client/dist/index.html\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Sorry! This is an error page\"</span> <span class=\"token operator\">>></span> client/dist/error.html</code></pre></div>\n<p>Because Serverless Finch can take potentially destructive actions (overwriting existing files, changing bucket policies, etc.) the plugin should now display a confirmation prompt prior to taking any action. After entering <code class=\"language-text\">Y</code> for yes you should then see something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"serverless:looking for bucket...\"><pre class=\"language-serverless:looking for bucket...\"><code class=\"language-serverless:looking for bucket...\">Serverless: Bucket found...\nServerless: Deleting all objects from bucket...\nServerless: Configuring bucket...\nServerless: Configuring policy for bucket...\nServerless: Configuring CORS for bucket...\nServerless: Uploading client files to bucket...\nServerless: Success! Your site should be available at http://your-unique-s3-bucketname.s3-website-us-east-1.amazonaws.com/</code></pre></div>\n<p>After that, congrats! You’ve just deployed your static website. Go ahead and visit the domain shown to confirm your site was deployed.</p>\n<h2>Advanced Features</h2>\n<p>Okay, so the basic tutorial was nice and all, but what if you want to set a custom distribution folder? Custom index and error documents? Or maybe use this with a custom domain? Here are a few common questions and answers for power users.</p>\n<p><strong>Can I make the distribution folder something other than <code class=\"language-text\">client/dist</code>?</strong></p>\n<p>Yes. Just add a distributionFolder path value to the <code class=\"language-text\">serverless.yml</code> file this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">custom</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">...</span>\n    <span class=\"token key atrule\">distributionFolder</span><span class=\"token punctuation\">:</span> location/of/files\n    <span class=\"token punctuation\">...</span></code></pre></div>\n<p>Keep in mind that this path is relative to the location of <code class=\"language-text\">serverless.yml</code>.</p>\n<p><strong>Can I set custom index and error documents?</strong></p>\n<p>Yes! Just add a line to serverless.yml for each: </p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">custom</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">...</span>\n    <span class=\"token key atrule\">indexDocument</span><span class=\"token punctuation\">:</span> custom<span class=\"token punctuation\">-</span>index.html\n    <span class=\"token key atrule\">errorDocument</span><span class=\"token punctuation\">:</span> custom<span class=\"token punctuation\">-</span>error.html\n    <span class=\"token punctuation\">...</span></code></pre></div>\n<p>Keep in mind that you will need to put these inside whatever distribution folder you configure though!</p>\n<p><strong>How does Serverless Finch integrate with custom domains?</strong></p>\n<p>Great question! We’re currently considering additional functionality to help manage custom domains. Currently, you can register your own domain on Route 53 and then point that domain to the S3 bucket using an AWS A record alias (this requires the bucket to share the name with the custom domain). </p>\n<p>You can also create a CloudFront Distribution to cache the files in your S3 bucket, and then point your custom domain to that CloudFront distribution with a Route 53 A record alias. The benefit of CloudFront is that you can also get a free HTTPS certificate and you can name your S3 bucket whatever you want.</p>\n<p>Either way, I’d recommend you determine how to setup your custom domain based on what’s best for your needs, and then use Serverless Finch to update and deploy the changes inside your S3 bucket (which should update your site regardless of the option you choose).</p>\n<p><strong>What other customizations can I make?</strong></p>\n<p>Lots! For a full list of features, you can <a href=\"https://github.com/fernando-mc/serverless-finch#configuration-parameters\">view the project on GitHub</a>. Don’t see something that you think would be a useful feature? We are happy to add in your contributions! </p>\n<h2>Final Thoughts</h2>\n<p>About a year ago, I <a href=\"https://www.fernandomc.com/posts/publishing-serverless-finch/\">adopted and republished</a> a broken Serverless Framework plugin that turned into Serverless Finch. Over the last year, the community has added a bunch of new features with more on the way.</p>\n<p>If you’re interested in becoming a contributor or maintainer please <a href=\"https://github.com/fernando-mc/serverless-finch\">open a PR</a> or <a href=\"https://www.fernandomc.com/contact/\">get in touch</a>.</p>","frontmatter":{"title":"Deploy a Serverless Frontend with the Serverless Finch Plugin","date":"August 06, 2018","description":"Learn how to deploy a static website to AWS with the Serverless Finch Plugin."}}},"pageContext":{"slug":"/posts/2018-08-06-deploy-serverless-frontend-with-serverless-finch-plugin/","previous":{"fields":{"slug":"/posts/2018-07-31-serverlessconf-recap-san-francisco-2018-key-takeaways-future-serverless/"},"frontmatter":{"title":"ServerlessConf 2018 San Francisco: key takeaways for the future of serverless"}},"next":{"fields":{"slug":"/posts/2018-08-07-how-use-event-gateway-use-cases-rest-api-custom-events/"},"frontmatter":{"title":"How to use the Serverless Event Gateway: build a REST API and react to custom events"}}}}}