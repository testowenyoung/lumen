{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2019-11-21-debugging-with-tags/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"c9225ff0-84e3-57d2-93f7-02fb8c1d5a84","excerpt":"Debugging Serverless Application Errors When a customer reports an issue that you can’t replicate, but you still need to solve, what do you do? You can release…","html":"<h4>Debugging Serverless Application Errors</h4>\n<p>When a customer reports an issue that you can’t replicate, but you still need to solve, what do you do? You can release a change with a log statement, then start monitoring logs to try and catch the customer’s function, and hope you see the error again. That can be a long and fruitless task.</p>\n<p>We’ve been there ourselves! That’s why we’ve added tags to the Serverless Framework dashboard’s debugging tool, the explorer. </p>\n<p><img src=\"https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/debugging-tags/tags-img-01.png\" alt=\"Tags in dashboard\"></p>\n<p>Our new tag filters can do the tracking for you. Now, when you’re trying to debug an issue that’s hard to track or hard to replicate, try this: log when you’re in the error state, tag that log line, and output a JSON object that represents some state of your application. Open the explorer, filter on that tag and view the invocations the explorer finds for you. </p>\n<p><img src=\"https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/debugging-tags/tags-img-2.png\" alt=\"Tags in dashboard\"></p>\n<p>Here’s an example of how we’ve used it; the API that powers the Serverless Framework dashboard is monitored within the dashboard (yes, we eat our own dogfood). One of our customers reported a query error, but no actual errors were being raised. We created a tag, and used it to find their invocation logs, so we could study the state of our application during the time their functions were invoked.</p>\n<p>Instead of trying to track their invocations ourselves, we let the explorer do it. The time we spent was entirely focused on understanding the issue, not hunting for logs. </p>\n<p>If you want to try tags in the explorer, you’ll first need to add some to your Serverless.yml file.</p>\n<h4>Tagging with NodeJS</h4>\n<p>If you’re using NodeJS, update serverless with npm update -g  serverless</p>\n<p>Add this code to your Serverless.yml file: </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span>hello <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> event<span class=\"token punctuation\">,</span> <span class=\"token parameter\">context</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n context<span class=\"token punctuation\">.</span>serverlessSdk<span class=\"token punctuation\">.</span><span class=\"token function\">tagEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'customerId'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> newCustomer<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> isDemo<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> demoExpire<span class=\"token operator\">:</span> <span class=\"token string\">'2019-12-01'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n <span class=\"token function\">tagEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'200 OK'</span><span class=\"token punctuation\">)</span>\n <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n   statusCode<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n   body<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>\n     <span class=\"token punctuation\">{</span>\n       message<span class=\"token operator\">:</span> <span class=\"token string\">'Go Serverless v1.0! Your function executed successfully!'</span><span class=\"token punctuation\">,</span>\n       input<span class=\"token operator\">:</span> event<span class=\"token punctuation\">,</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n     <span class=\"token number\">2</span>\n   <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>Tagging with Python</h4>\n<p>If you’re using Python, add this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">def <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n   context<span class=\"token punctuation\">.</span>serverless_sdk<span class=\"token punctuation\">.</span><span class=\"token function\">tag_event</span><span class=\"token punctuation\">(</span><span class=\"token string\">'customerId'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'newCustomer'</span><span class=\"token operator\">:</span> True<span class=\"token punctuation\">,</span> <span class=\"token string\">'isDemo'</span><span class=\"token operator\">:</span> True<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n   body <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token string\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Go Serverless v1.0! Your function executed successfully!\"</span><span class=\"token punctuation\">,</span>\n       <span class=\"token string\">\"input\"</span><span class=\"token operator\">:</span> event\n   <span class=\"token punctuation\">}</span>\n\n   response <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token string\">\"statusCode\"</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n       <span class=\"token string\">\"body\"</span><span class=\"token operator\">:</span> json<span class=\"token punctuation\">.</span><span class=\"token function\">dumps</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span>\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you’d like to learn more about tagging Lambda functions, check out Jeremy Daly’s blog post, “<a href=\"https://www.jeremydaly.com/how-to-tag-your-lambda-functions-for-smarter-serverless-applications/\">How to tag your Lambdas for smarter serverless applications</a>“. </p>\n<p>Learn more about <a href=\"https://serverless.com/debugging/\">debugging with the explorer</a>, and open up your Serverless Framework Dashboard and explore tags for yourself!</p>","frontmatter":{"title":"Resolve Serverless Errors the Easy Way- with Tags","date":"November 21, 2019","description":"Tag your Lambdas to track errors and debug serverless applications. If you’re using NodeJS or Python, we’ll help you find even the trickiest serverless application errors faster."}}},"pageContext":{"slug":"/posts/2019-11-21-debugging-with-tags/","previous":{"fields":{"slug":"/posts/2019-11-19-api-gateway-troubleshooting/"},"frontmatter":{"title":"Take the legwork out of API Gateway troubleshooting"}},"next":{"fields":{"slug":"/posts/2019-11-21-aws-lambda-supported-languages-and-runtimes/"},"frontmatter":{"title":"The State of AWS Lambda Supported Languages & Runtimes (Updated November 2019)"}}}}}