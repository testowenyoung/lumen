{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2019-04-23-framework-release-v141/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"f8b86fa9-1961-5fbe-b31d-75ece0d59c55","excerpt":"With the Serverless Framework v1.41.0 release, we’re adding AWS X-Ray Tracing support for API Gateway, which complements the AWS tracing story and makes it…","html":"<p>With the Serverless Framework v1.41.0 release, we’re adding AWS X-Ray Tracing support for API Gateway, which complements the AWS tracing story and makes it possible to trace incoming events from API Gateway all the way through your Lambda functions. Our new version also adds support for multiple API Gateway usage plan and key definitions as well as lots of enhancements for local function invocations via Docker. In addition to that, we also addressed a couple of bug fixes and enhancements. 1 bug fix and 7 enhancements were merged and are now available in our v1.41.0 release.</p>\n<h3>X-Ray support for AWS API Gateway</h3>\n<p>AWS API Gateway is one of the central services used in many serverless applications. Interactions with an API Gateway-driven serverless backend start with an event which is triggered via an HTTP request and then re-routed to the corresponding AWS Lambda function.</p>\n<p>It would be great to monitor and trace requests through the service-stack to better understand how requests are processed and where they spend most of their lifetime.</p>\n<p>In one of our <a href=\"https://serverless.com/blog/framework-release-v140/\">previous Serverless Framework releases</a> we introduced AWS X-Ray Tracing for AWS Lambda. With this post, we now complete the picture by adding <a href=\"https://docs.aws.amazon.com/xray/index.html\">AWS X-Ray</a> Tracing support for API Gateway.</p>\n<p>Enabling tracing for API Gateway is as easy as enabling the corresponding config on the <code class=\"language-text\">provider</code> property:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">tracing</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">apiGateway</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>X-Ray tracing works best when it’s used across multiple AWS services. If you’re using X-Ray Tracing for API Gateway you might want to enable it for your Lambda functions as well:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">tracing</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">apiGateway</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">lambda</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>This way you can get more insights into your API Gateway → Lambda setup when using the <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-using-xray-maps.html?shortFooter=true#apigateway-using-xray-maps-active\">X-Ray Tracing Service Map</a></p>\n<p><strong>IMPORTANT:</strong>\nDue to CloudFormation limitations it’s not possible to enable AWS X-Ray Tracing on existing deployments which don’t use tracing right now.</p>\n<p>Please remove the old API Gateway and re-deploy it with tracing enabled if you want to use AWS X-Ray Tracing for API Gateway.</p>\n<h3>Support for multiple usage plans</h3>\n<p>Sometimes it’s useful to limit access to your API Gateway when exposing it to the public. In previous versions of the Serverless Framework this could be easily done via <a href=\"https://serverless.com/framework/docs/providers/aws/events/apigateway/#setting-api-keys-for-your-rest-api\">API Keys and usage plans</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n <span class=\"token key atrule\">apiKeys</span><span class=\"token punctuation\">:</span>\n   <span class=\"token punctuation\">-</span> keyOne\n   <span class=\"token punctuation\">-</span> keyTwo\n <span class=\"token key atrule\">usagePlan</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">quota</span><span class=\"token punctuation\">:</span>\n     <span class=\"token key atrule\">limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5000</span>\n     <span class=\"token key atrule\">offset</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n     <span class=\"token key atrule\">period</span><span class=\"token punctuation\">:</span> MONTH\n   <span class=\"token key atrule\">throttle</span><span class=\"token punctuation\">:</span>\n     <span class=\"token key atrule\">burstLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>\n     <span class=\"token key atrule\">rateLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span></code></pre></div>\n<p>The initial implementation which supported one usage plan and multiple API Keys was usually enough for simple API Gateway setups.</p>\n<p>However in production setups one usually needs more flexibility. It’s very common to have different types of usage plans for different user types, such as “free” plan users and “paid” plan users.</p>\n<p>The Serverless Framework v1.41.0 adds support for multiple usage plans. Multiple API Keys can be assigned to each usage plan:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n  <span class=\"token key atrule\">apiKeys</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">free</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> freeKeyOne\n      <span class=\"token punctuation\">-</span> freeKeyTwo\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">paid</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> paidKeyOne\n      <span class=\"token punctuation\">-</span> paidKeyTwo\n  <span class=\"token key atrule\">usagePlan</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">free</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">quota</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5000</span>\n          <span class=\"token key atrule\">offset</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n          <span class=\"token key atrule\">period</span><span class=\"token punctuation\">:</span> MONTH\n        <span class=\"token key atrule\">throttle</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">burstLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>\n          <span class=\"token key atrule\">rateLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">paid</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">quota</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50000</span>\n          <span class=\"token key atrule\">offset</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n          <span class=\"token key atrule\">period</span><span class=\"token punctuation\">:</span> MONTH\n        <span class=\"token key atrule\">throttle</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">burstLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2000</span>\n          <span class=\"token key atrule\">rateLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1000</span></code></pre></div>\n<h3>Docker Invoke Local improvements</h3>\n<p>Serverless Framework <a href=\"https://serverless.com/blog/framework-release-v140/\">recently added support</a> for local function invocation via Docker, meaning that every AWS Lambda runtime can now be invoked locally in a Docker container.</p>\n<p>Serverless Framework v1.41.0 adds support for:\n<a href=\"https://github.com/serverless/serverless/pull/5988\">function environment variables</a>;\n<a href=\"https://github.com/serverless/serverless/pull/5977\">access to function dependencies</a>;\n<a href=\"https://github.com/serverless/serverless/pull/5992\">lambda layer download caching</a>; and\n<a href=\"https://github.com/serverless/serverless/pull/5994\">Docker argument passing</a>.</p>\n<h4>Bug Fixes</h4>\n<ul>\n<li><a href=\"https://github.com/serverless/serverless/pull/5988\">#5988</a> #5945: Invoke local docker to pass env vars to lambda container<a href=\"https://github.com/serverless/serverless/pull/5988/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+80</span>/<span style=\"color:#cb2431\">-4</span></a> <a href=\"https://github.com/endeepak\"> <img src=\"https://avatars0.githubusercontent.com/u/310608?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> endeepak</a></li>\n</ul>\n<h4>Enhancements</h4>\n<ul>\n<li><a href=\"https://github.com/serverless/serverless/pull/5964\">#5964</a> Add error message when provider does not exist<a href=\"https://github.com/serverless/serverless/pull/5964/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+15</span>/<span style=\"color:#cb2431\">-0</span></a> <a href=\"https://github.com/Xenonym\"> <img src=\"https://avatars0.githubusercontent.com/u/1782590?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> Xenonym</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5973\">#5973</a> The code for removing comments is easy to read<a href=\"https://github.com/serverless/serverless/pull/5973/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+0</span>/<span style=\"color:#cb2431\">-2</span></a> <a href=\"https://github.com/xichengliudui\"> <img src=\"https://avatars3.githubusercontent.com/u/40875627?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> xichengliudui</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5977\">#5977</a> #5947: Ensure invoke local docker runs lambda with the dependencies<a href=\"https://github.com/serverless/serverless/pull/5977/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+32</span>/<span style=\"color:#cb2431\">-22</span></a> <a href=\"https://github.com/endeepak\"> <img src=\"https://avatars0.githubusercontent.com/u/310608?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> endeepak</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5997\">#5997</a> Add additional Capability when Transform is detected<a href=\"https://github.com/serverless/serverless/pull/5997/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+54</span>/<span style=\"color:#cb2431\">-0</span></a> <a href=\"https://github.com/pofallon\"> <img src=\"https://avatars0.githubusercontent.com/u/505519?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> pofallon</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/6010\">#6010</a> Allow specifying a retention policy for lambda layers<a href=\"https://github.com/serverless/serverless/pull/6010/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+63</span>/<span style=\"color:#cb2431\">-1</span></a> <a href=\"https://github.com/dschep\"> <img src=\"https://avatars0.githubusercontent.com/u/667763?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> dschep</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/6011\">#6011</a> Updating Node.js runtime version<a href=\"https://github.com/serverless/serverless/pull/6011/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+1</span>/<span style=\"color:#cb2431\">-1</span></a> <a href=\"https://github.com/ffxsam\"> <img src=\"https://avatars2.githubusercontent.com/u/12532733?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> ffxsam</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/6013\">#6013</a> Make it easier on the eyes of serverless newcomers<a href=\"https://github.com/serverless/serverless/pull/6013/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+3</span>/<span style=\"color:#cb2431\">-3</span></a> <a href=\"https://github.com/guerrerocarlos\"> <img src=\"https://avatars2.githubusercontent.com/u/82532?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> guerrerocarlos</a></li>\n</ul>\n<h4>Documentation</h4>\n<ul>\n<li><a href=\"https://github.com/serverless/serverless/pull/6018\">#6018</a> Update quick-start.md<a href=\"https://github.com/serverless/serverless/pull/6018/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+1</span>/<span style=\"color:#cb2431\">-1</span></a> <a href=\"https://github.com/allanchua101\"> <img src=\"https://avatars1.githubusercontent.com/u/26626798?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> allanchua101</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/6023\">#6023</a> Update newsletter + enterprise link in readme<a href=\"https://github.com/serverless/serverless/pull/6023/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+1</span>/<span style=\"color:#cb2431\">-1</span></a> <a href=\"https://github.com/pdaryani\"> <img src=\"https://avatars1.githubusercontent.com/u/43791027?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> pdaryani</a></li>\n</ul>\n<h4>Features</h4>\n<ul>\n<li><a href=\"https://github.com/serverless/serverless/pull/5692\">#5692</a> Add AWS x-ray support for API Gateway<a href=\"https://github.com/serverless/serverless/pull/5692/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+368</span>/<span style=\"color:#cb2431\">-2</span></a> <a href=\"https://github.com/softprops\"> <img src=\"https://avatars3.githubusercontent.com/u/2242?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> softprops</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5954\">#5954</a> #4750 Java invoke local support for handlers that implement RequestStreamHandler<a href=\"https://github.com/serverless/serverless/pull/5954/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+138</span>/<span style=\"color:#cb2431\">-7</span></a> <a href=\"https://github.com/XaeroDegreaz\"> <img src=\"https://avatars3.githubusercontent.com/u/312459?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> XaeroDegreaz</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5970\">#5970</a> Add support for multiple usage plans<a href=\"https://github.com/serverless/serverless/pull/5970/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+875</span>/<span style=\"color:#cb2431\">-173</span></a> <a href=\"https://github.com/pmuens\"> <img src=\"https://avatars3.githubusercontent.com/u/1606004?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> pmuens</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5971\">#5971</a> Added rust template for Cloudflare WASM<a href=\"https://github.com/serverless/serverless/pull/5971/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+151</span>/<span style=\"color:#cb2431\">-0</span></a> <a href=\"https://github.com/jspies\"> <img src=\"https://avatars1.githubusercontent.com/u/13679?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> jspies</a></li>\n<li><a href=\"https://github.com/serverless/serverless/pull/5994\">#5994</a> #5993: Ability to pass args for docker run command during invoke local docker<a href=\"https://github.com/serverless/serverless/pull/5994/files?utf8=✓&diff=split\" style=\"text-decoration:none;\"> <span style=\"color:#28a647\">+56</span>/<span style=\"color:#cb2431\">-4</span></a> <a href=\"https://github.com/endeepak\"> <img src=\"https://avatars0.githubusercontent.com/u/310608?v=4\" style=\"vertical-align: middle\" alt height=\"20px\"> endeepak</a></li>\n</ul>\n<h3>Contributor thanks</h3>\n<p>As always, we appreciate each and every one of you that use and contribute to the Framework and Serverless ecosystem!</p>","frontmatter":{"title":"Serverless Framework v1.41 - X-Ray for API Gateway, Invoke Local with Docker Improvements & More","date":"April 23, 2019","description":"Check out what’s included in Serverless Framework v1.41."}}},"pageContext":{"slug":"/posts/2019-04-23-framework-release-v141/","previous":{"fields":{"slug":"/posts/2019-04-05-framework-release-v140/"},"frontmatter":{"title":"Serverless Framework v1.40"}},"next":{"fields":{"slug":"/posts/2019-04-24-ao-serverless-first/"},"frontmatter":{"title":"AO.com: the path to Serverless First"}}}}}