{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2017-03-07-static-site-post-scheduler/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"c919b88f-909d-583c-8c05-2c5281630e5c","excerpt":"Like many static sites we use Markdown + GitHub for all of our blog content. Having content under version control comes with some great benefits: It‚Äôs open‚Ä¶","html":"<img align=\"right\" width=\"250\" height=\"123\" src=\"https://cloud.githubusercontent.com/assets/532272/23386639/779ce26c-fd0c-11e6-9e54-f33281e17719.jpg\">\n<p>Like many static sites we use Markdown + GitHub for all of our <a href=\"https://github.com/serverless/blog/\">blog content</a>.</p>\n<p>Having content under version control comes with some great benefits:</p>\n<ul>\n<li><strong>It‚Äôs open</strong> - Anyone can submit/update content and fix typos via pull requests</li>\n<li><strong>Version control</strong> - Roll back &#x26; see the history of any given post</li>\n<li><strong>No CMS lock in</strong> - We can easily port to any static site generator</li>\n<li><strong>It‚Äôs just simple</strong> - No user accounts to manage, no CMS software to upgrade, no plugins to install.</li>\n</ul>\n<p>All that said, there are some <em>missing features</em> when it comes to running your site or blog via a static site generator.</p>\n<p>Lacking the ability to <strong>schedule posts</strong> to publish at a specific time is a pain. Publishing content to our <a href=\"https://github.com/serverless/site\">static site</a> and <a href=\"https://github.com/serverless/blog/\">blog</a> has been a manual process.</p>\n<p>We had to physically be at our keyboards and click the ‚Äúmerge‚Äù button in GitHub.</p>\n<p>How antiquated‚Ä¶</p>\n<p>So I thought to myself:</p>\n<blockquote>\n<p>There has got to be a better way‚Ä¶ a better <strong>serverless</strong> way.</p>\n<ul>\n<li><strong>David‚Äôs brain</strong></li>\n</ul>\n</blockquote>\n<h2>Introducing the Post Scheduler for Static Websites</h2>\n<p>The <a href=\"https://github.com/serverless/post-scheduler/\">post scheduler</a> is a Serverless project that gives static site owners the ability to schedule posts (or other site content).</p>\n<p>It works with any static site setup (Jekyll, Hugo, Phenomic, Gatsby etc.)</p>\n<p><strong>How much does it cost?:</strong></p>\n<p>It‚Äôs <strong>free</strong> and open source project. You can easily run under this under the generous free tier of AWS.</p>\n<p>Just clone it down, add in your repo details and <code class=\"language-text\">sls deploy</code> it into your AWS account.</p>\n<p><strong>Before:</strong></p>\n<p>Late night manual merges <strong>üôà</strong></p>\n<p><strong>After:</strong></p>\n<p>Sipping margaritas on the beach while posts are being published automatically. <strong>üéâ</strong></p>\n<h2>Show Me The üí∏ (Demo)</h2>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/YETxuhexZY4?list=PLIIjEI2fYC-BubklemD4D51vrXHOcUOpc\" frameborder=\"0\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<p><a href=\"https://www.youtube.com/watch?v=YETxuhexZY4&#x26;index=1&#x26;list=PLIIjEI2fYC-BubklemD4D51vrXHOcUOpc\">Watch the rest of the playlist on youtube</a></p>\n<h2>How It Works</h2>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/RaJw_6s5nWc?list=PLIIjEI2fYC-BubklemD4D51vrXHOcUOpc\" frameborder=\"0\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<ol>\n<li>A GitHub webhook fires when a pull request (aka new posts or site content) is updated.</li>\n<li>If the pull request comment has a comment matching <code class=\"language-text\">schedule(MM/DD/YYYY H:MM pm)</code> &#x26; the person is a collaborator on the project, the post/content gets scheduled for you.</li>\n<li>A serverless cron job runs every hour to check if a post is ready to be published.</li>\n<li>When the post is ready to be published, the cron function automatically merges the branch into <code class=\"language-text\">master</code> and your site, if you have CI/CD built in, will redeploy itself.</li>\n</ol>\n<p>To cancel scheduled posts, delete the scheduled comment and it will unschedule the branch.</p>\n<h3>Github Webhook Architecture</h3>\n<p><img src=\"https://cloud.githubusercontent.com/assets/532272/23387076/2e7960b2-fd0f-11e6-88da-49517b27d8ae.png\" alt=\"cloudcraft - post scheduler webhook\"></p>\n<h3>Cron Job Architecture</h3>\n<p><img src=\"https://cloud.githubusercontent.com/assets/532272/23388042/e129772e-fd14-11e6-96ca-ff23a019a51e.png\" alt=\"cloudcraft - post scheduler cron setup\"></p>\n<h2>How to Install</h2>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/rfZPQX-PQkQ\" frameborder=\"0\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<h3>1. Clone down the <a href=\"https://github.com/serverless/post-scheduler/\">repository</a> and run <code class=\"language-text\">npm install</code> to install the dependencies</h3>\n<h3>2. Duplicate <code class=\"language-text\">config.prod.example.json</code> into a new file called <code class=\"language-text\">config.prod.json</code> and insert your Github username, API token, and webhook secret</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// config.prod.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"serviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blog-scheduler\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"region\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"us-west-2\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"TIMEZONE\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"America/Los_Angeles\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"CRON\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cron(0 * * * ? *)\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"GITHUB_REPO\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"serverless/blog\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"GITHUB_WEBHOOK_SECRET\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"YOUR_GITHUB_WEBHOOK_SECRET_HERE\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"GITHUB_API_TOKEN\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"YOUR_GITHUB_API_TOKEN_HERE\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"GITHUB_USERNAME\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"YOUR_GITHUB_USERNAME_HERE\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">serviceName</code> - name of the service that will appear in your AWS account</li>\n<li><code class=\"language-text\">region</code> - AWS region to deploy the functions and database in</li>\n<li><code class=\"language-text\">TIMEZONE</code> - Timezone the cron runs on. See <code class=\"language-text\">timezone.json</code> for available options</li>\n<li><code class=\"language-text\">CRON</code> - How often you want to check for scheduled posts? See the <a href=\"http://docs.aws.amazon.com/AmazonCloudWatch/latest/events/ScheduledEvents.html\">AWS cron docs</a> or <a href=\"https://serverless.com/framework/docs/providers/aws/events/schedule/\">serverless <code class=\"language-text\">schedule</code> docs</a> for more information. <strong>Default:</strong> every hour on the hour</li>\n<li><code class=\"language-text\">GITHUB_REPO</code> - The <code class=\"language-text\">owner/repoName</code> of your repository</li>\n<li><code class=\"language-text\">GITHUB_WEBHOOK_SECRET</code> - Any string you want. This gets plugged into your webhook settings</li>\n<li><code class=\"language-text\">GITHUB_API_TOKEN</code> - Personal access token. See below for additional info</li>\n<li><code class=\"language-text\">GITHUB_USERNAME</code> - Your github username. Used for requests to github</li>\n</ul>\n<h3>3. Deploy the service with <code class=\"language-text\">serverless deploy</code>. If you need to setup Serverless, please see <a href=\"https://github.com/serverless/serverless#quick-start\">these install instructions</a>.</h3>\n<h3>4. Take the POST endpoint returned from deploy and plug it into your <a href=\"https://youtu.be/b_DVXgiByec?t=1m9s\">repositories settings in github</a></h3>\n<p><img src=\"https://cloud.githubusercontent.com/assets/532272/23144203/e0dada50-f77a-11e6-8da3-7bdbcaf8f2a0.png\" alt=\"image\"></p>\n<ol>\n<li>Add your GitHub webhook listener URL into the <code class=\"language-text\">Payload URL</code> and choose type <code class=\"language-text\">application/json</code></li>\n<li>Plugin your <code class=\"language-text\">GITHUB_WEBHOOK_SECRET</code> defined in your config file</li>\n<li>Select which GitHub events will trigger your webhook</li>\n<li>Select Issue comments, these will be where you insert <code class=\"language-text\">schedule(MM/DD/YYYY H:MM pm)</code> comments in a given PR</li>\n</ol>\n<h3>5. Submit a PR and give it a go!</h3>\n<h2>Contributions Welcome</h2>\n<p>Have an idea on how we can improve the static site post scheduler?</p>\n<p>Leave us a comment below, <a href=\"https://github.com/serverless/post-scheduler/\">submit a PR</a>, or tweet <a href=\"https://twitter.com/davidwells\">@DavidWells</a></p>\n<h2>Was this post scheduled?</h2>\n<p>How did you guess it?</p>\n<p><a href=\"https://github.com/serverless/blog/pull/94\">This post was scheduled!</a></p>","frontmatter":{"title":"How To Schedule Posts for Static Site Generators (Jekyll, Hugo, Phenomic etc.)","date":"March 07, 2017","description":"Open source static site scheduler tool built with serverless"}}},"pageContext":{"slug":"/posts/2017-03-07-static-site-post-scheduler/","previous":{"fields":{"slug":"/posts/2017-02-28-tdd-serverless/"},"frontmatter":{"title":"Test-Driven Serverless Application Development"}},"next":{"fields":{"slug":"/posts/2017-03-02-advanced-plugin-development-extending-the-core-lifecycle/"},"frontmatter":{"title":"Advanced Plugin Development - Extending The Serverless Core Lifecycle"}}}}}