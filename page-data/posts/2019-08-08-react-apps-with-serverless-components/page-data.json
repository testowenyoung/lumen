{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/2019-08-08-react-apps-with-serverless-components/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"c20e4ad5-2476-5924-aaa5-912e73cfda34","excerpt":"Note: This post is based on the beta version of Serverless Components, which is not compatible with the latest, and much faster, GA version. Please check out…","html":"<blockquote>\n<p>Note: This post is based on the beta version of Serverless Components, which is not compatible with the latest, and much faster, GA version. Please check out the <a href=\"https://github.com/serverless/components\">docs of the GA version of Serverless Components</a> for more up to date information.</p>\n</blockquote>\n<p>Here’s a tutorial on how you can deploy React applications that are fast, global and cheap to host.</p>\n<p>The outcome of this is a website with a React app, a custom domain and SSL certificate — <strong>Basically, everything you need to be production ready.</strong></p>\n<p>And all of this will be made simple via the Serverless Framework and its new Serverless Components feature.</p>\n<p>This post features few images because an entire walkthrough video of this tutorial can be found here:</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/ts26BVuX3j0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<h3>Overview</h3>\n<p>Your React app will be distributed via a global Content Delivery Network.  This enables it to have incredibly fast performance around the world.</p>\n<p>And we will be using possibly the cheapest infrastructure to do this which is S3 and Cloudfront from Amazon Web Services.</p>\n<p>How cheap is that?  </p>\n<p>For a year, you can transfer 50 GB of data and serve 2 million requests a month, <strong>for free</strong>.  </p>\n<p>After that, it will cost you 8-2 cents per GB, depending on how much data you transfer, plus 1 cent per 10,000 HTTPs requests.  Check out the AWS Cloudfront pricing page for more details.</p>\n<p>You will have to pay for your custom domain.  However, you will get a free public SSL certificate from AWS Certificate Manager.</p>\n<p>Now a disclaimer – I did not analyze all of the options on the market for static site hosting before this, so I’m not aware of cheaper alternatives that may exist.  But, S3 and Cloudfront have been around for many years.  They’re reliable and fast.  Actually, many products for static site hosting are built on S3 and Cloudfront and charge you a mark-up.</p>\n<p>The reason why developers don’t often use plain AWS S3 and AWS Cloudfront is because the experience of using them is just too darn complicated, compared to other offerings.</p>\n<p>However, this is where Serverless Framework comes in.  It brings a great developer experience to all infrastructure providers, especially infrastructure with auto-scaling, pay-per-use, AKA “serverless” qualities.</p>\n<h3>Set-Up</h3>\n<p>Before doing anything, you will need to have an AWS account.  You must have a credit card to sign up, though you will not be charged until you go over the free tier limits.</p>\n<p>Next, log into AWS, navigate to the IAM dashboard to create access keys that the Serverless Framework will use to provision the infrastructure needed for your React website.</p>\n<p>Go to “Users”, and click “add user”.  Give it a name that includes serverless-framework then click enable “Programmatic Access”, and click “Next”.  </p>\n<p>Select “Attach existing policies directly”.  Check the box next to “AdministratorAccess”.  Hit “Next” and “Next” again to skip the tags screen, then hit “Create”.</p>\n<p>Note:  Later, you may want to scope down these permissions so the Serverless Framework will the least amount of access necessary.  Though, this can be complex because the Serverless Framework uses many AWS services.  To give you a helping hand here, the Website Component currently uses S3, Certificate Manager, Cloudfront and Route53, and needs access specifically for those.</p>\n<p>Copy the “Access Key ID” and the “Secret Access Key”.  You will need them in second… </p>\n<p>Now, it’s time for the fun Serverless Framework part.</p>\n<p>Make sure you have <a href=\"https://nodejs.org/en/download/\">Node.js</a> installed.  Then, install the Serverless Framework via NPM and add the global flag <code class=\"language-text\">-g</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> i -g serverless</code></pre></div>\n<p>Make sure you have Serverless Framework version 1.49 or later installed.  Hint:  If you’re installing it right now, you will.</p>\n<p>We’re going to use a Website template that has all of the scaffolding you need to get started quickly.  It’s a complete boilerplate.  Install the Website template using this command.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ serverless create --template-url https://github.com/serverless/components/tree/master/templates/website</code></pre></div>\n<p>This will create a <code class=\"language-text\">website</code> folder for you.</p>\n<p>Go into that folder and install the React dependencies via npm by running <code class=\"language-text\">npm i</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npm i</code></pre></div>\n<p>Also in the <code class=\"language-text\">website</code> folder, create a file named <code class=\"language-text\">.env</code> and paste in your AWS Keys, formatted like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">AWS_ACCESS_KEY_ID=A92JA098J10FAJ10JAAFASF\nAWS_SECRET_ACCESS_KEY=fJajajaf0919jIJFJA7813hAAFJHL</code></pre></div>\n<p>You’re done with set-up.  It’s time to start development!</p>\n<h3>Development</h3>\n<p>This project uses React and Parcel for building and bundling the application.</p>\n<p>You can also run the application locally with Parcel using this command:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npm run start</code></pre></div>\n<p>Now, you can develop rapidly.</p>\n<h3>Deployment</h3>\n<p>Out of the box, the Website template should be ready to deploy.</p>\n<p>If you look at your <code class=\"language-text\">serverless.yml</code> file, you will see a Serverless Compont in it titled “website”.  A Serverless Component is simply code that knows how to deploy the cloud infrastructure needed to create a specific outcome or use-case.</p>\n<p>Serverless Components are open-source and you can use them to easily deploy lots of use-cases on serverless cloud infrastructure.  <a href=\"https://www.github.com/serverless/components\">Check them out here</a>.</p>\n<p>Every Serverless Component has an <code class=\"language-text\">inputs</code> property, which allows you to configure the use-case that the Component will provision.  For example, here you can see the <code class=\"language-text\">src</code> input that points to the directory containing your website assets.  As well as a <code class=\"language-text\">hook</code> to call in order to build your website before deployment. This way, you don’t have to run the build script before deploying, it just happens automatically.</p>\n<p>Alright, let’s get to the deployment part!</p>\n<p>To deploy your React app, in your website folder, simply run the <code class=\"language-text\">serverless</code> command.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ serverless</code></pre></div>\n<p>Your website should deploy in less than a minute and you should get URL pointing to your live website!.  </p>\n<p>The first deployment always takes the longest because creating cloud infrastructure resources can be more time-consuming than updating them.</p>\n<p><strong>Setting Up A Custom Domain, Cloudfront &#x26; SSL Certificate</strong></p>\n<p>To set up your custom domain, your Cloudfront CDN and an SSL certificate, you will need to do one manual step: you must log into your AWS account and purchase your domain.  Currently, the Website Component only works with domains purchased on AWS Route53.  Within the next few weeks, we will enable support for existing domains registered on different registrars.</p>\n<p>Go to AWS Route53’s dashboard, egister your domain and wait for the registration to complete.  This could take up to an hour.  Once it has completed, simply add in the custom domain to the Website Component’s inputs.</p>\n<p>Run <code class=\"language-text\">serverless</code> again and it will acknowledge the new <code class=\"language-text\">input</code> and set up your custom domain, Cloudfront &#x26; SSL Certificate.</p>\n<p>You will need to wait for your new domain to propagate to the DNS servers around the world. This may take up to an hour as well. Once it’s available, you will be able to see it live, as well as any changes you make.</p>\n<p>Every time you run <code class=\"language-text\">serverless</code> to deploy changes to your website, the Website Component invalidates the assets you have cached in AWS Cloudfront. This enables you to see changes almost immediately.</p>\n<h3>State Management</h3>\n<p>Currently, Serverless Components do not have remote state management.  This is coming within a month.  Until then, make sure you push the <code class=\"language-text\">.serverless</code> directory to Github, since it contains state info about the cloud infrastructure resources that have been deployed for your website.</p>\n<h3>Adding A Serverless API Backend, Database &#x26; More</h3>\n<p>If you want to go further and build out a fullstack application just as easily as this website, check out <a href=\"https://github.com/serverless/components/tree/master/templates/fullstack-application\">the fullstack application template</a>.  This will give you everything you need to deliver a fast, cheap and global entire serverless application.</p>\n<p>Enjoy!</p>","frontmatter":{"title":"Fast, Cheap & Global React Apps via Serverless Framework Components (Video)","date":"August 07, 2019","description":"Easily deploy React applications that are fast, global and cheap to host on AWS S3 and AWS Cloudfront."}}},"pageContext":{"slug":"/posts/2019-08-08-react-apps-with-serverless-components/","previous":{"fields":{"slug":"/posts/2019-08-12-10-tips-creating-robust-serverless-components/"},"frontmatter":{"title":"10 Tips for Creating Robust Serverless Components"}},"next":{"fields":{"slug":"/posts/2019-08-07-serverless-for-startups/"},"frontmatter":{"title":"Serverless: The Ideal Choice For Startups? (CloudForecast Case Study)"}}}}}